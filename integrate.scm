;(load "utils")

(define (gauss-legendre npts)
  (cond ((= npts 1) '((2) (0)))
	((= npts 2) '((1 1)
		      (-0.5773502691896257
			0.5773502691896257)))
	((= npts 3) '(( 0.8888888888888888
		        0.5555555555555556
		        0.5555555555555556)
		      ( 0.0000000000000000
		       -0.7745966692414834
		        0.7745966692414834)))
	((= npts 4) '(( 0.6521451548625461
		        0.6521451548625461
		        0.3478548451374538
		        0.3478548451374538)
		     ( -0.3399810435848563
		        0.3399810435848563
		       -0.8611363115940526
		        0.8611363115940526)))))

(define (integrate f rule)
  (foldl + 0 (map (lambda (w g)
		    (* w (f g)))
		  (car rule)
		  (cadr rule))))
